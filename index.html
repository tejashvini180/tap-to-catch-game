<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catch My Hearts ‚ù§Ô∏è</title>
<style>
body{margin:0;background:black;color:white;text-align:center;font-family:Arial;overflow:hidden;}
#gameContainer{width:100%;max-width:500px;margin:0 auto;position:relative;}
canvas{display:block;border:2px solid pink;background:#111;margin:0 auto;}
button{padding:15px 25px;font-size:20px;border:none;border-radius:10px;background:pink;color:black;cursor:pointer;margin:10px;}
#scoreBoard{font-size:24px;margin:10px;}
</style>
</head>
<body>

<h1>üíñ Catch My Hearts</h1>
<p>Click, swipe, or use arrow keys to move the basket! üòò</p>
<button id="startBtn">‚ñ∂ Start Game</button>
<div id="scoreBoard">Score: 0</div>
<div id="gameContainer">
<canvas id="game"></canvas>
</div>

<audio id="bgm" loop preload="auto">
<source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let hearts=[], score=0, game=null;

// Basket
let basket={x:0,y:0,w:0,h:0,speed:0};
let heartSize=0;

// ---------- RESIZE CANVAS ----------
function resizeCanvas(){
    // Internal pixel size = visible size
    canvas.width = Math.min(window.innerWidth, 500);
    canvas.height = canvas.width * 1.5;

    // Basket
    basket.w = canvas.width * 0.2;
    basket.h = canvas.height * 0.03;
    basket.speed = canvas.width * 0.05;
    basket.y = canvas.height - basket.h - 10;

    // Keep basket visible on resize
    basket.x = Math.min(basket.x || canvas.width/2 - basket.w/2, canvas.width - basket.w);

    // Heart size
    heartSize = canvas.width * 0.075;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// ---------- HEART CLASS ----------
class Heart{
    constructor(x,y){
        this.x = x;
        this.y = y;
        this.size = heartSize*(Math.random()*0.5 + 0.75);
        this.speed = Math.random()*2 + 2;
    }
    draw(){
        ctx.fillStyle="pink";
        ctx.beginPath();
        ctx.moveTo(this.x,this.y);
        ctx.arc(this.x-this.size/4,this.y,this.size/4,Math.PI,0);
        ctx.arc(this.x+this.size/4,this.y,this.size/4,Math.PI,0);
        ctx.lineTo(this.x,this.y+this.size/2);
        ctx.closePath();
        ctx.fill();
    }
}

// ---------- SPAWN HEART ----------
function spawnHeart(){
    const x = Math.random() * (canvas.width - heartSize) + heartSize/2;
    hearts.push(new Heart(x, -heartSize));
}

// ---------- DRAW ----------
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Draw hearts
    for(let i=hearts.length-1;i>=0;i--){
        const h = hearts[i];
        h.y += h.speed;
        h.draw();

        // Catch
        if(h.y + h.size/2 >= basket.y && h.x > basket.x && h.x < basket.x + basket.w){
            hearts.splice(i,1);
            score++;
            document.getElementById("scoreBoard").innerText = "Score: "+score;
            if(score >= 10){
                clearInterval(game);
                proposal();
                return;
            }
        }

        // Remove off-screen
        if(h.y > canvas.height) hearts.splice(i,1);
    }

    // Draw basket
    ctx.fillStyle="pink";
    ctx.fillRect(basket.x, basket.y, basket.w, basket.h);

    requestAnimationFrame(draw);
}

// ---------- START GAME ----------
document.getElementById("startBtn").addEventListener("click",()=>{
    const music = document.getElementById("bgm");
    music.muted=false;
    music.volume=1;
    music.play().catch(e=>console.log("Audio blocked"));

    document.getElementById("startBtn").style.display="none";
    score = 0;
    hearts = [];
    basket.x = canvas.width/2 - basket.w/2;
    document.getElementById("scoreBoard").innerText = "Score: 0";

    game = setInterval(spawnHeart,700);
    requestAnimationFrame(draw);
});

// ---------- CONTROLS ----------
// Keyboard
document.addEventListener("keydown", e=>{
    if(e.key==="ArrowLeft") basket.x = Math.max(0, basket.x - basket.speed);
    if(e.key==="ArrowRight") basket.x = Math.min(canvas.width - basket.w, basket.x + basket.speed);
});

// Click left/right
canvas.addEventListener("click", e=>{
    const rect = canvas.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    if(clickX < canvas.width/2) basket.x = Math.max(0, basket.x - basket.speed);
    else basket.x = Math.min(canvas.width - basket.w, basket.x + basket.speed);
});

// Swipe
let touchStartX = null;
canvas.addEventListener("touchstart", e => touchStartX = e.touches[0].clientX);
canvas.addEventListener("touchmove", e => {
    if(!touchStartX) return;
    const touchX = e.touches[0].clientX;
    const delta = touchX - touchStartX;
    basket.x += delta;
    if(basket.x < 0) basket.x = 0;
    if(basket.x + basket.w > canvas.width) basket.x = canvas.width - basket.w;
    touchStartX = touchX;
    e.preventDefault();
});

// ---------- PROPOSAL ----------
function proposal(){
    const music = document.getElementById("bgm");
    music.pause();
    document.body.innerHTML = `
    <canvas id="fire" width="800" height="600"></canvas>
    <div style="position:absolute;top:20%;width:100%;text-align:center;">
        <h1 style="color:pink;">üéÜ You Caught All My Hearts ‚ù§Ô∏è</h1>
        <p style="color:white;">Will You Be Mine Forever?</p>
        <button onclick="yes()">YES üíñ</button>
        <button id="noBtn" style="background:#ff4d6d;color:white;">NO üòú</button>
    </div>`;
    const noBtn = document.getElementById("noBtn");
    noBtn.onmouseover = ()=>{
        noBtn.style.position="absolute";
        noBtn.style.left = Math.random()*80 + "%";
        noBtn.style.top = Math.random()*80 + "%";
    };
}

// ---------- YES + FIREWORKS ----------
function yes(){
    document.body.innerHTML = `
    <canvas id="fire" width="800" height="600"></canvas>
    <div style="position:absolute;top:20%;width:100%;text-align:center;">
        <h1 style="color:pink;">üéÜ SHE SAID YES ‚ù§Ô∏è</h1>
        <p style="color:white;">Forever starts now üíñ</p>
        <p style="color:pink;font-size:18px;">
            Dear Hero,<br><br>
            You caught all my hearts ‚ù§Ô∏è<br>
            Thank you for being my everything.
        </p>
    </div>`;
    fireworks();
}

// ---------- FIREWORKS ----------
function fireworks(){
    const c = document.getElementById("fire");
    const x = c.getContext("2d");
    let particles = [];
    function spawn(){
        for(let i=0;i<120;i++){
            particles.push({
                x:400,y:300,
                dx:(Math.random()-0.5)*6,
                dy:(Math.random()-0.5)*6,
                life:100
            });
        }
    }
    function animate(){
        x.fillStyle="rgba(0,0,0,0.2)";
        x.fillRect(0,0,800,600);
        particles.forEach(p=>{
            x.fillStyle="pink";
            x.fillRect(p.x,p.y,3,3);
            p.x += p.dx;
            p.y += p.dy;
            p.life--;
        });
        particles = particles.filter(p=>p.life>0);
        requestAnimationFrame(animate);
    }
    spawn();
    animate();
}
</script>
</body>
</html>





